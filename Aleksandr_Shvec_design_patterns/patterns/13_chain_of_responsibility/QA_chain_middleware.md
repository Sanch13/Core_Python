# ‚ùì –í–æ–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Chain of Responsibility

## –í–æ–ø—Ä–æ—Å 1: –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞

**–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –∫ —Ç–µ–±–µ –ø—Ä–∏—à—ë–ª junior —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏ —Å–ø—Ä–æ—Å–∏–ª: "–ó–∞—á–µ–º –Ω—É–∂–µ–Ω Chain of Responsibility? 
–ü–æ—á–µ–º—É –±—ã –Ω–µ –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–æ –æ–¥–∏–Ω –±–æ–ª—å—à–æ–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –≤ –º–µ—Ç–æ–¥–µ `process_request()`?"**

–ö–∞–∫ —Ç—ã –µ–º—É –æ—Ç–≤–µ—Ç–∏—à—å? –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–∞—ë—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤?

---

## –í–æ–ø—Ä–æ—Å 2: –ü–æ—Ä—è–¥–æ–∫ middleware

**–í —Ç–≤–æ—ë–º –∫–æ–¥–µ —Ü–µ–ø–æ—á–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ —Ç–∞–∫:**
```
AuthenticationMiddleware ‚Üí AuthorizationMiddleware ‚Üí RateLimitMiddleware ‚Üí LoggingMiddleware ‚Üí RequestHandlerMiddleware
```

**–í–æ–ø—Ä–æ—Å—ã:**
1. –ú–æ–∂–Ω–æ –ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ `AuthenticationMiddleware` –∏ `AuthorizationMiddleware`? –ß—Ç–æ –±—É–¥–µ—Ç?
2. –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å `RateLimitMiddleware` –≤ —Å–∞–º–æ–µ –Ω–∞—á–∞–ª–æ (–ø–µ—Ä–µ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π)?
3. –ï—Å—Ç—å –ª–∏ "–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π" –ø–æ—Ä—è–¥–æ–∫ middleware, –∏–ª–∏ —ç—Ç–æ –Ω–µ –≤–∞–∂–Ω–æ?

---

## –í–æ–ø—Ä–æ—Å 3: –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏

**–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —ç—Ç–æ—Ç –∫–æ–¥:**
```python
class AuthenticationMiddleware(Middleware):
    def handle(self, request: Request):
        if self._header_auth not in request.headers:
            return "401 Unauthorized: Missing authentication token"
        
        # ... –¥–∞–ª—å–Ω–µ–π—à–∞—è –ª–æ–≥–∏–∫–∞ ...
        
        if self._next_middleware:
            return self._next_middleware.handle(request)
```

**–í–æ–ø—Ä–æ—Å:** –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å —Ü–µ–ø–æ—á–∫–æ–π, –∫–æ–≥–¥–∞ middleware –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, "401 Unauthorized")? –í—ã–∑—ã–≤–∞—é—Ç—Å—è –ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ middleware –≤ —Ü–µ–ø–∏? –ü–æ—á–µ–º—É?

---

## –í–æ–ø—Ä–æ—Å 4: –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å

**–í —Ç–≤–æ—ë–º –∫–æ–¥–µ –µ—Å—Ç—å –º–µ—Ç–æ–¥ –≤ –±–∞–∑–æ–≤–æ–º –∫–ª–∞—Å—Å–µ:**
```python
class Middleware(ABC):
    @abstractmethod
    def handle(self, request: Request): ...
```

**–í–æ–ø—Ä–æ—Å:** –ü–æ—á–µ–º—É –º–µ—Ç–æ–¥ `handle()` –æ–±—ä—è–≤–ª–µ–Ω –∫–∞–∫ `@abstractmethod`? –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ —É–±—Ä–∞—Ç—å `@abstractmethod` –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ –æ–±—ã—á–Ω—ã–π –º–µ—Ç–æ–¥ —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å—Ä–∞–∑—É –ø–µ—Ä–µ–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –¥–∞–ª—å—à–µ)?

---

## –í–æ–ø—Ä–æ—Å 5: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞

**–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –≤ `AuthenticationMiddleware`:**
```python
request.user_role = "admin"
request.user_id = 1
```

**–í–æ–ø—Ä–æ—Å:** Middleware **–∏–∑–º–µ–Ω—è–µ—Ç** –æ–±—ä–µ–∫—Ç `request`. –°–ª–µ–¥—É—é—â–∏–µ middleware –≤ —Ü–µ–ø–æ—á–∫–µ –≤–∏–¥—è—Ç —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `AuthorizationMiddleware` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `request.user_role`). 

–≠—Ç–æ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –∏–ª–∏ –ø–ª–æ—Ö–∞—è? –ö–∞–∫–∏–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤–Ω—É—Ç—Ä–∏ middleware?

---

## –í–æ–ø—Ä–æ—Å 6: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –ø–∞—Ç—Ç–µ—Ä–Ω—É

**–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç–≤–æ–π –∫–æ–ª–ª–µ–≥–∞ –ø—Ä–µ–¥–ª–æ–∂–∏–ª –¥—Ä—É–≥–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**

```python
def process_request(request):
    # –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if not check_auth(request):
        return "401 Unauthorized"
    
    # –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    if not check_permissions(request):
        return "403 Forbidden"
    
    # –®–∞–≥ 3: Rate limiting
    if not check_rate_limit(request):
        return "429 Too Many Requests"
    
    # –®–∞–≥ 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    log_request(request)
    
    # –®–∞–≥ 5: –û–±—Ä–∞–±–æ—Ç–∫–∞
    return handle_request(request)
```

**–í–æ–ø—Ä–æ—Å:** –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —ç—Ç–∏–º –ø–æ–¥—Ö–æ–¥–æ–º –∏ Chain of Responsibility? –ö–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω, –∞ –∫–æ–≥–¥–∞ ‚Äî –ø—Ä–æ—Å—Ç—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π?

---

## –í–æ–ø—Ä–æ—Å 7: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏

**–í–æ–ø—Ä–æ—Å:** –ú–æ–∂–Ω–æ –ª–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑–º–µ–Ω–∏—Ç—å —Ü–µ–ø–æ—á–∫—É middleware? –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ–¥–Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å rate limiting, –∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö ‚Äî –Ω–µ—Ç. –ö–∞–∫ –±—ã —Ç—ã —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª —Å —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π?

---

## –í–æ–ø—Ä–æ—Å 8: –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞

**–í–æ–ø—Ä–æ—Å:** –¢—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –ø–∞—Ç—Ç–µ—Ä–Ω. –ö–∞–∫–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ç—ã –≤–∏–¥–∏—à—å –≤ Chain of Responsibility –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–æ–µ–≥–æ –æ–ø—ã—Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞? –ß—Ç–æ –±—ã–ª–æ –Ω–µ—É–¥–æ–±–Ω–æ –∏–ª–∏ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ?

---

# üìù –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

–ú–æ–∂–µ—à—å –æ—Ç–≤–µ—Ç–∏—Ç—å —Ç–∞–∫:
```
–í–æ–ø—Ä–æ—Å 1: [—Ç–≤–æ–π –æ—Ç–≤–µ—Ç]
–í–æ–ø—Ä–æ—Å 2: 
  1) [–æ—Ç–≤–µ—Ç]
  2) [–æ—Ç–≤–µ—Ç]
  3) [–æ—Ç–≤–µ—Ç]
–í–æ–ø—Ä–æ—Å 3: [—Ç–≤–æ–π –æ—Ç–≤–µ—Ç]
...
```

**–û—Ç–≤–µ—á–∞–π —á–µ—Å—Ç–Ω–æ –∏ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏. –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å ‚Äî —Ç–∞–∫ –∏ –Ω–∞–ø–∏—à–∏, –º—ã —Ä–∞–∑–±–µ—Ä—ë–º –≤–º–µ—Å—Ç–µ! üöÄ**

–ñ–¥—É —Ç–≤–æ–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤! üí™


# üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤

–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –¢—ã –ø–æ–∫–∞–∑–∞–ª —Ö–æ—Ä–æ—à–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ.

---

## ‚úÖ –í–æ–ø—Ä–æ—Å 1: –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è ‚Äî **–û–¢–õ–ò–ß–ù–û!**

> –º—ã —Ä–∞–∑–¥–µ–ª—è–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –∏ –Ω–µ –Ω–∞—Ä—É—à–∞–µ–º –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–ª–∏–¥.
> –º—ã –º–æ–∂–µ–º –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏ —Å—Ç—Ä–æ–∏—Ç—å —Ü–µ–ø–æ—á–∫–∏ –∫–∞–∫ –∑–∞—Ö–æ—Ç–∏–º...
> –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ü–µ–ø–æ—á–∫—É –Ω–æ–≤–æ–µ –∑–≤–µ–Ω–æ –º—ã —É–Ω–∞—Å–ª–µ–¥—É–µ–º—Å—è –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏...

**–û—Ü–µ–Ω–∫–∞: 10/10** üéâ

–¢—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤! –î–æ–±–∞–≤–ª—é –µ—â—ë –ø–∞—Ä—É –≤–∞–∂–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤:
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** ‚Äî –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ middleware –≤ —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ø–æ—á–∫–∞—Ö
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π middleware –æ—Ç–¥–µ–ª—å–Ω–æ
- **–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å** ‚Äî –∫–æ–¥ –ª–µ–≥—á–µ —á–∏—Ç–∞—Ç—å: –æ–¥–∏–Ω –∫–ª–∞—Å—Å = –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

---

## ‚ö†Ô∏è –í–æ–ø—Ä–æ—Å 2: –ü–æ—Ä—è–¥–æ–∫ middleware ‚Äî **–ß–ê–°–¢–ò–ß–ù–û –ü–†–ê–í–ò–õ–¨–ù–û**

### 2.1. –ú–æ–∂–Ω–æ –ª–∏ –ø–æ–º–µ–Ω—è—Ç—å AuthenticationMiddleware –∏ AuthorizationMiddleware?

> –Ω–µ–ª—å–∑—è.

**–û—Ü–µ–Ω–∫–∞: 10/10** ‚úÖ

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ!** –ï—Å–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏:
```python
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
AuthorizationMiddleware ‚Üí AuthenticationMiddleware
```

`AuthorizationMiddleware` –ø—Ä–æ–≤–µ—Ä–∏—Ç `request.user_role`, –Ω–æ –æ–Ω –±—É–¥–µ—Ç `None` 
(–ø–æ—Ç–æ–º—É —á—Ç–æ `AuthenticationMiddleware` –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª —Ä–æ–ª—å). –ü–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

---

### 2.2. RateLimitMiddleware –≤ –Ω–∞—á–∞–ª–µ?

> –æ–Ω –±—É–¥–µ—Ç –æ—Ç—Å–µ–∫–∞—Ç—å —Å—Ä–∞–∑—É –∂–µ —É –∫–æ–≥–æ –±–æ–ª–µ–µ 5 –≤—Ö–æ–¥–æ–≤

**–û—Ü–µ–Ω–∫–∞: 8/10** ‚úÖ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –Ω–µ–ø–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç)

**–î–∞, –Ω–æ –µ—Å—Ç—å –Ω—é–∞–Ω—Å!** –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ **–ø–ª—é—Å–æ–º**, —Ç–∞–∫ –∏ **–º–∏–Ω—É—Å–æ–º**:

**üëç –ü–ª—é—Å (–∑–∞—â–∏—Ç–∞ –æ—Ç DDoS):**
```python
# Rate Limiting –ü–ï–†–í–´–ú ‚Äî —ç–∫–æ–Ω–æ–º–∏–º —Ä–µ—Å—É—Ä—Å—ã
RateLimitMiddleware ‚Üí AuthenticationMiddleware ‚Üí ...
```
- –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ **–¥–æ** –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞
- –ù–µ —Ç—Ä–∞—Ç–∏–º —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É —Ç–æ–∫–µ–Ω–∞/–ø—Ä–æ–≤–µ—Ä–∫—É –ë–î
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞

**üëé –ú–∏–Ω—É—Å (–±–ª–æ–∫–∏—Ä—É–µ–º –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∑–∞—Å–ø–∞–º–∏—Ç—å –∑–∞–ø—Ä–æ—Å–∞–º–∏ **–ë–ï–ó —Ç–æ–∫–µ–Ω–∞**
- –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–¥—ë—Ç —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º, –Ω–æ –ø–æ–ª—É—á–∏—Ç 429 (–ø–æ—Ç–æ–º—É —á—Ç–æ –ª–∏–º–∏—Ç —É–∂–µ –∏—Å—á–µ—Ä–ø–∞–Ω –∞—Ç–∞–∫—É—é—â–∏–º —Å —Ç–æ–≥–æ –∂–µ IP)

**–í—ã–≤–æ–¥:** –û–±—ã—á–Ω–æ RateLimitMiddleware —Å—Ç–∞–≤—è—Ç **–ø–æ—Å–ª–µ** –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —á—Ç–æ–±—ã –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å **–ø–æ user_id**, –∞ –Ω–µ –ø–æ IP:

```python
class RateLimitMiddleware(Middleware):
    def __init__(self):
        super().__init__()
        self.user_limits = defaultdict(int)  # ‚Üê –ü–æ user_id, –∞ –Ω–µ IP
```

---

### 2.3. –ï—Å—Ç—å –ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫?

> –µ—Å—Ç—å –∏ —ç—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ

**–û—Ü–µ–Ω–∫–∞: 10/10** ‚úÖ

**–ê–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ—Ä–Ω–æ!** –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫:
```
1. Rate Limiting (–ø–æ IP) ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS
2. Authentication ‚Äî –∫—Ç–æ —Ç—ã?
3. Rate Limiting (–ø–æ user_id) ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã
4. Authorization ‚Äî —á—Ç–æ —Ç–µ–±–µ –º–æ–∂–Ω–æ?
5. Logging ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å
6. Business Logic ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
```

---

## ‚úÖ –í–æ–ø—Ä–æ—Å 3: –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ ‚Äî **–û–¢–õ–ò–ß–ù–û!**

> –Ω–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã —Å—Ä–∞–∑—É –ø—Ä–µ—Ä—ã–≤–∞–µ–º –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç

**–û—Ü–µ–Ω–∫–∞: 10/10** üéâ

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ!** –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **"short-circuit"** (–∫–æ—Ä–æ—Ç–∫–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ):

```python
if error:
    return "401 Unauthorized"  # ‚Üê –°—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—Ç, —Å–ª–µ–¥—É—é—â–∏–µ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è

if self._next_middleware:
    return self._next_middleware.handle(request)  # ‚Üê –°—é–¥–∞ –Ω–µ –¥–æ–π–¥—ë–º
```

---

## ‚ö†Ô∏è –í–æ–ø—Ä–æ—Å 4: @abstractmethod ‚Äî **–ù–ï–ü–û–õ–ù–´–ô –û–¢–í–ï–¢**

> –±—É–¥–µ—Ç –ø–ª–æ—Ö–æ —Ç–∞–∫ –∫–∞–∫ —É –∫–∞–∂–¥–æ–≥–æ middleware –±—É–¥–µ—Ç —Å–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ–¥–Ω–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ –ø–æ–∫—Ä–æ–µ—Ç –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

**–û—Ü–µ–Ω–∫–∞: 6/10** ‚ö†Ô∏è

**–¢—ã –ø—Ä–∞–≤, –Ω–æ –Ω–µ —Å–æ–≤—Å–µ–º —Ç–æ—á–Ω–æ.** –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º:

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç @abstractmethod?

```python
from abc import ABC, abstractmethod

class Middleware(ABC):
    @abstractmethod
    def handle(self, request: Request): ...
```

**@abstractmethod –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ:**
1. –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞:
```python
m = Middleware()  # ‚ùå TypeError: Can't instantiate abstract class
```

2. –í—Å–µ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ **–û–ë–Ø–ó–ê–ù–´** —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥:
```python
class MyMiddleware(Middleware):
    pass  # ‚ùå TypeError: Can't instantiate without implementing handle()
```

### –ß—Ç–æ –±—É–¥–µ—Ç –ë–ï–ó @abstractmethod?

```python
class Middleware:  # ‚Üê –£–±—Ä–∞–ª–∏ ABC –∏ @abstractmethod
    def handle(self, request: Request):
        if self._next_middleware:
            return self._next_middleware.handle(request)
        return "No handler"
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–∂–µ—Ç –∑–∞–±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `handle()`:
```python
class BrokenMiddleware(Middleware):
    pass  # ‚Üê –ó–∞–±—ã–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å handle()

broken = BrokenMiddleware()  # ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è –±–µ–∑ –æ—à–∏–±–∫–∏!
broken.handle(request)  # ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑–æ–≤—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
```

**–í—ã–≤–æ–¥:** `@abstractmethod` ‚Äî —ç—Ç–æ **–∫–æ–Ω—Ç—Ä–∞–∫—Ç**: "–¢—ã –û–ë–Ø–ó–ê–ù —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥, –∏–Ω–∞—á–µ –∫–æ–¥ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è".

---

## ‚ùå –í–æ–ø—Ä–æ—Å 5: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è request ‚Äî **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!**

> –ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞. –ø—Ä–æ–±–ª–µ–º–∞ —á—Ç–æ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å admin

**–û—Ü–µ–Ω–∫–∞: 3/10** ‚ùå

**–¢—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–Ω—è–ª –≤–æ–ø—Ä–æ—Å!** –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º:

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –∫–æ–¥–µ?

```python
class AuthenticationMiddleware(Middleware):
    def handle(self, request: Request):
        # ... –ø—Ä–æ–≤–µ—Ä–∫–∏ ...
        request.user_role = "admin"  # ‚Üê –ò–∑–º–µ–Ω—è–µ–º –æ–±—ä–µ–∫—Ç request
        request.user_id = 1
```

### –≠—Ç–æ –ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞?

**–ù–ï–¢! –≠—Ç–æ –ù–û–†–ú–ê–õ–¨–ù–û –∏ –¥–∞–∂–µ –ü–†–ê–í–ò–õ–¨–ù–û** –≤ Chain of Responsibility! ‚úÖ

**–ü–æ—á–µ–º—É:**
- Middleware **–¥–æ–ª–∂–Ω—ã –æ–±–æ–≥–∞—â–∞—Ç—å** –æ–±—ä–µ–∫—Ç request –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- `AuthenticationMiddleware` –ø—Ä–æ–≤–µ—Ä–∏–ª —Ç–æ–∫–µ–Ω ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏–ª `user_id` –∏ `user_role`
- `AuthorizationMiddleware` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤
- –≠—Ç–æ **–ø–µ—Ä–µ–¥–∞—á–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è** –ø–æ —Ü–µ–ø–æ—á–∫–µ

### –¢–≤–æ—è –æ—à–∏–±–∫–∞: "–æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å admin"

**–≠—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ!** –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –ª–æ–≥–∏–∫—É:
```python
if "admin" in token:  # ‚Üê –ü—Ä–æ–≤–µ—Ä—è–µ–º –¢–û–ö–ï–ù
    request.user_role = "admin"
```

–ï—Å–ª–∏ –≤ —Ç–æ–∫–µ–Ω–µ –Ω–µ—Ç —Å–ª–æ–≤–∞ "admin", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—Ç–∞–Ω–µ—Ç –∞–¥–º–∏–Ω–æ–º. –¢–æ–∫–µ–Ω –ø—Ä–∏—Ö–æ–¥–∏—Ç –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞, –Ω–æ **middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å**.

### –ö–æ–≥–¥–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è request ‚Äî –ü–õ–û–•–ê–Ø –ø—Ä–∞–∫—Ç–∏–∫–∞?

```python
class EvilMiddleware(Middleware):
    def handle(self, request: Request):
        request.user_role = "admin"  # ‚ùå –î–∞—ë–º –∞–¥–º–∏–Ω–∫—É –≤—Å–µ–º –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏!
        return self._next_middleware.handle(request)
```

**–ù–æ –≤ —Ç–≤–æ—ë–º –∫–æ–¥–µ –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** ‚úÖ

---

## ‚ö†Ô∏è –í–æ–ø—Ä–æ—Å 6: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã ‚Äî **–ù–ï–¢–û–ß–ù–û**

> –≤–æ–∑–º–æ–∂–Ω–æ –∫–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ –±–æ–ª—å—à–∞—è –¥–æ 5. –µ—Å–ª–∏ –±–æ–ª—å—à–µ —Ç–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω

**–û—Ü–µ–Ω–∫–∞: 4/10** ‚ö†Ô∏è

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ ‚Äî –ù–ï –≥–ª–∞–≤–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π!**

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏?

```python
def process_order(order):
    validate_order(order)
    calculate_total(order)
    apply_discount(order)
    charge_payment(order)
    send_confirmation(order)
```

**–ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏:**
- ‚úÖ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è** (–≤—Å–µ–≥–¥–∞ –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ)
- ‚úÖ –í—Å–µ —à–∞–≥–∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã**
- ‚úÖ –ù–µ –Ω—É–∂–Ω–∞ **–≥–∏–±–∫–æ—Å—Ç—å** –≤ –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Chain of Responsibility?

```python
auth.set_next(authz).set_next(rate).set_next(log).set_next(handler)
```

**–ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏:**
- ‚úÖ –ü–æ—Ä—è–¥–æ–∫ –º–æ–∂–µ—Ç **–º–µ–Ω—è—Ç—å—Å—è**
- ‚úÖ –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —à–∞–≥–∏ **–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã**
- ‚úÖ –ù—É–∂–Ω–æ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏** —Å—Ç—Ä–æ–∏—Ç—å —Ü–µ–ø–æ—á–∫—É
- ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ **–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è** –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ö
- ‚úÖ –¶–µ–ø–æ—á–∫–∞ –º–æ–∂–µ—Ç **–ø—Ä–µ—Ä—ã–≤–∞—Ç—å—Å—è** –Ω–∞ –ª—é–±–æ–º —à–∞–≥–µ

**–ü—Ä–∏–º–µ—Ä:**
```python
# –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
chain1 = auth ‚Üí authz ‚Üí rate ‚Üí handler

# –î–ª—è –∞–¥–º–∏–Ω–æ–≤ (–±–µ–∑ rate limiting)
chain2 = auth ‚Üí authz ‚Üí handler

# –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ API (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
chain3 = rate ‚Üí handler
```

---

## ‚úÖ –í–æ–ø—Ä–æ—Å 7: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Äî **–•–û–†–û–®–ê–Ø –ü–û–ü–´–¢–ö–ê!**

> —è –Ω–µ –∑–Ω–∞—é, –Ω–æ –¥—É–º–∞—é —á—Ç–æ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ. –ø—Ä–µ–¥–ø–æ–ª–æ–∂—É —á—Ç–æ —Å–¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥—É—é —Ü–µ–ø–æ—á–∫—É (–≤–æ–∑–º–æ–∂–Ω–æ –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–∫—Å–∏?).

**–û—Ü–µ–Ω–∫–∞: 7/10** ‚úÖ (—á–µ—Å—Ç–Ω–æ—Å—Ç—å + –ª–æ–≥–∏—á–Ω–æ–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ)

**–î–∞, —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ!** –í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤:

### –°–ø–æ—Å–æ–± 1: –£—Å–ª–æ–≤–Ω—ã–π middleware

```python
class ConditionalRateLimitMiddleware(Middleware):
    def __init__(self, rate_limiter: RateLimitMiddleware):
        super().__init__()
        self.rate_limiter = rate_limiter
    
    def handle(self, request: Request):
        # –ü—Ä–∏–º–µ–Ω—è–µ–º rate limiting —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ-–∞–¥–º–∏–Ω–æ–≤
        if request.user_role != "admin":
            result = self.rate_limiter.handle(request)
            if "429" in result:
                return result
        
        if self._next_middleware:
            return self._next_middleware.handle(request)
```

### –°–ø–æ—Å–æ–± 2: –§–∞–±—Ä–∏–∫–∞ —Ü–µ–ø–æ—á–µ–∫ (—Ç–≤–æ—è –∏–¥–µ—è –±–ª–∏–∑–∫–∞!)

```python
class MiddlewareChainFactory:
    @staticmethod
    def create_chain_for_user(user_role: str) -> Middleware:
        auth = AuthenticationMiddleware()
        authz = AuthorizationMiddleware()
        log = LoggingMiddleware()
        handler = RequestHandlerMiddleware()
        
        if user_role == "admin":
            # –ê–¥–º–∏–Ω–∞–º –±–µ–∑ rate limiting
            auth.set_next(authz).set_next(log).set_next(handler)
        else:
            # –û–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å rate limiting
            rate = RateLimitMiddleware()
            auth.set_next(authz).set_next(rate).set_next(log).set_next(handler)
        
        return auth
```

### –°–ø–æ—Å–æ–± 3: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≤—Å—Ç–∞–≤–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ

```python
# –£–¥–∞–ª—è–µ–º middleware –∏–∑ —Ü–µ–ø–æ—á–∫–∏
auth.set_next(log)  # ‚Üê –ü—Ä–æ–ø—É—Å–∫–∞–µ–º rate_limiter

# –ò–ª–∏ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É –Ω–∞ –ª–µ—Ç—É
if user.is_premium():
    chain = auth ‚Üí authz ‚Üí handler
else:
    chain = auth ‚Üí authz ‚Üí rate ‚Üí handler
```

**–¢–≤–æ—è –∏–Ω—Ç—É–∏—Ü–∏—è –ø—Ä–æ "–æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å" –≤–µ—Ä–Ω–∞—è!** –≠—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω **Factory** –∏–ª–∏ **Builder**, –∞ –Ω–µ Proxy.

---

## ‚úÖ –í–æ–ø—Ä–æ—Å 8: –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ ‚Äî **–ù–ï –û–¢–í–ï–¢–ò–õ**

**–î–∞–≤–∞–π —è —Ä–∞—Å—Å–∫–∞–∂—É –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Ç—ã –º–æ–≥ —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è:**

### 1. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏**
```python
result = auth.handle(request)
# –ì–¥–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞? –í auth? authz? rate? log?
# –ù—É–∂–Ω–æ debugger –∏–ª–∏ –º–Ω–æ–≥–æ –ø—Ä–∏–Ω—Ç–æ–≤
```

### 2. **–ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏**
```python
# –ß—Ç–æ –µ—Å–ª–∏ –∑–∞–±—ã–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π handler?
auth.set_next(authz).set_next(rate)  # ‚Üê –ù–µ—Ç handler!
# –ó–∞–ø—Ä–æ—Å –¥–æ–π–¥—ë—Ç –¥–æ –∫–æ–Ω—Ü–∞ –∏ –≤–µ—Ä–Ω—ë—Ç "No more handlers in chain"
```

### 3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
```python
# –ó–∞–ø—Ä–æ—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –í–°–ï middleware, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ
auth ‚Üí authz ‚Üí rate ‚Üí log ‚Üí handler
# 5 –≤—ã–∑–æ–≤–æ–≤ –º–µ—Ç–æ–¥–æ–≤ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ
```

### 4. **–ù–µ—è–≤–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**
```python
# AuthorizationMiddleware –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ AuthenticationMiddleware
# —É—Å—Ç–∞–Ω–æ–≤–∏–ª user_role, –Ω–æ —ç—Ç–æ –Ω–µ—è–≤–Ω–æ
# –ï—Å–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ ‚Äî –≤—Å—ë —Å–ª–æ–º–∞–µ—Ç—Å—è
```

---

# üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

| –í–æ–ø—Ä–æ—Å | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|--------|-------------|
| 1. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ | 10/10 | –û—Ç–ª–∏—á–Ω–æ! |
| 2. –ü–æ—Ä—è–¥–æ–∫ middleware | 9/10 | –ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ |
| 3. –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ | 10/10 | –û—Ç–ª–∏—á–Ω–æ! |
| 4. @abstractmethod | 6/10 | –ù–µ–ø–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ |
| 5. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è request | 3/10 | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è |
| 6. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã | 4/10 | –ö—Ä–∏—Ç–µ—Ä–∏–π –≤—ã–±–æ—Ä–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π |
| 7. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ | 7/10 | –•–æ—Ä–æ—à–∞—è –ø–æ–ø—ã—Ç–∫–∞ |
| 8. –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ | 0/10 | –ù–µ –æ—Ç–≤–µ—Ç–∏–ª |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 6.1/10** 

---

# üéì –í—ã–≤–æ–¥—ã

## ‚úÖ –ß—Ç–æ —Ç—ã –ø–æ–Ω—è–ª —Ö–æ—Ä–æ—à–æ:
- –û—Å–Ω–æ–≤–Ω—É—é –∏–¥–µ—é –ø–∞—Ç—Ç–µ—Ä–Ω–∞
- –ü—Ä–∏–Ω—Ü–∏–ø—ã SOLID
- –í–∞–∂–Ω–æ—Å—Ç—å –ø–æ—Ä—è–¥–∫–∞ middleware
- –ú–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏

## ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–¥—Ç—è–Ω—É—Ç—å:
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ `@abstractmethod`
- –ö–æ–≥–¥–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞ –º–µ–∂–¥—É –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º –∏ –ø—Ä–æ—Å—Ç—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ)

---

# üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–µ—Ä–µ—á–∏—Ç–∞–π –º–æ–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è** –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º 4, 5, 6
2. **–ò—Å–ø—Ä–∞–≤—å –º–µ–ª–∫–∏–µ –Ω–µ–¥–æ—á—ë—Ç—ã** –≤ –∫–æ–¥–µ (–æ–ø–µ—á–∞—Ç–∫–∏, else)
3. **–ó–∞–ø—É—Å—Ç–∏ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é** —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. **–ü–æ–¥—É–º–∞–π:** –∫–∞–∫–∏–µ –µ—â—ë middleware –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å? (CORS, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞)

---

**–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üí™üî•**

–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–æ–∏–º –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º? ü§î
