"""
–û–¥–∏–Ω–æ—á–∫–∞ ‚Äî —ç—Ç–æ –ø–æ—Ä–æ–∂–¥–∞—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —É –∫–ª–∞—Å—Å–∞ –µ—Å—Ç—å
—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä, –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫ –Ω–µ–º—É –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø–∞.
–ü–∞—Ç—Ç–µ—Ä–Ω –û–¥–∏–Ω–æ—á–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–∞–º, –≥–¥–µ –Ω—É–∂–µ–Ω —Å—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏–ª–∏
–µ–¥–∏–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Settings/Config):
–£ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞
(–Ω–∞–ø—Ä–∏–º–µ—Ä, .env –∏–ª–∏ .yaml) –æ–¥–∏–Ω —Ä–∞–∑. –ï—Å–ª–∏ —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
–Ω–∞—Å—Ç—Ä–æ–µ–∫, —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω—É.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Logging):
–û–±—ã—á–Ω–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω –≥–ª–∞–≤–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ª–æ–≥–≥–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–∏—à–µ—Ç –≤ –æ–¥–∏–Ω –∏ —Ç–æ—Ç
–∂–µ —Ñ–∞–π–ª –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî —ç—Ç–æ
–ª–∏—à–Ω—è—è —Ç—Ä–∞—Ç–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ —Ñ–∞–π–ª.
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (Database Connection Pool):
–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö ‚Äî –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç
(–ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π), –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ —Å–≤—è–∑–∏ –∏ –≤—ã–¥–∞–µ—Ç –∏—Ö –ø–æ –∑–∞–ø—Ä–æ—Å—É.
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Caching):
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–µ—à –≤ –ø–∞–º—è—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞—Ä—å), –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±—â–∏–º –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
–ï—Å–ª–∏ –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —Å–æ–∑–¥–∞—Å—Ç —Å–≤–æ–π –∫–µ—à, —Å–º—ã—Å–ª–∞ –≤ –Ω–µ–º –Ω–µ –±—É–¥–µ—Ç.
- –î–æ—Å—Ç—É–ø –∫ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–º—É –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é:
–ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º –∏–ª–∏ COM-–ø–æ—Ä—Ç–æ–º, –æ–±—ã—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å,
—á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å —É–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–∏–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç,
 —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥—ã –Ω–µ –ø–µ—Ä–µ–º–µ—à–∞–ª–∏—Å—å
"""

from datetime import datetime
from typing import Optional


class AppLogger:
	"""
	Singleton –ª–æ–≥–≥–µ—Ä –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
	–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤—Å–µ —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–∏—à—É—Ç –≤ –æ–¥–∏–Ω –ª–æ–≥-—Ñ–∞–π–ª
	—á–µ—Ä–µ–∑ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –ª–æ–≥–≥–µ—Ä–∞.
	"""

	_instance: Optional['AppLogger'] = None
	_initialized: bool = False

	def __new__(cls):
		"""
		–ú–∞–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –î–û __init__.
		–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞.
		"""
		if cls._instance is None:
			print("üî® –°–æ–∑–¥–∞—ë–º –ø–µ—Ä–≤—ã–π (–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π) —ç–∫–∑–µ–º–ø–ª—è—Ä AppLogger")
			cls._instance = super().__new__(cls)
		else:
			print("‚ôªÔ∏è –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–∫–∑–µ–º–ø–ª—è—Ä AppLogger")
		return cls._instance

	def __init__(self):
		"""
		–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑,
		–¥–∞–∂–µ –µ—Å–ª–∏ __init__ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ.
		"""
		if not AppLogger._initialized:
			print("‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ª–æ–≥–≥–µ—Ä...")
			self.log_file = "app.log"
			self.logs = []
			AppLogger._initialized = True
		else:
			print("‚è≠Ô∏è –õ–æ–≥–≥–µ—Ä —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")

	def log(self, message: str, level: str = "INFO"):
		"""–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–≥"""
		timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
		log_entry = f"[{timestamp}] [{level}] {message}"
		self.logs.append(log_entry)
		print(f"üìù {log_entry}")

	def get_logs(self):
		"""–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –ª–æ–≥–∏"""
		return self.logs

	def clear_logs(self):
		"""–û—á–∏—â–∞–µ—Ç –ª–æ–≥–∏"""
		self.logs.clear()
		print("üóëÔ∏è –õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã")


# ============================================
# –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –†–ê–ë–û–¢–´
# ============================================

def main():
	print("=" * 60)
	print("–¢–ï–°–¢ 1: –°–æ–∑–¥–∞—ë–º –ø–µ—Ä–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä")
	print("=" * 60)
	logger1 = AppLogger()
	logger1.log("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ", "INFO")
	logger1.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à—ë–ª –≤ —Å–∏—Å—Ç–µ–º—É", "INFO")

	print("\n" + "=" * 60)
	print("–¢–ï–°–¢ 2: –ü—ã—Ç–∞–µ–º—Å—è —Å–æ–∑–¥–∞—Ç—å –≤—Ç–æ—Ä–æ–π —ç–∫–∑–µ–º–ø–ª—è—Ä")
	print("=" * 60)
	logger2 = AppLogger()
	logger2.log("–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç 'logger2'", "DEBUG")

	print("\n" + "=" * 60)
	print("–¢–ï–°–¢ 3: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç")
	print("=" * 60)
	print(f"logger1 is logger2: {logger1 is logger2}")
	print(f"id(logger1): {id(logger1)}")
	print(f"id(logger2): {id(logger2)}")

	print("\n" + "=" * 60)
	print("–¢–ï–°–¢ 4: –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –ª—é–±–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞")
	print("=" * 60)
	print("–õ–æ–≥–∏ –∏–∑ logger1:")
	for log in logger1.get_logs():
		print(f"  {log}")

	print("\n–õ–æ–≥–∏ –∏–∑ logger2:")
	for log in logger2.get_logs():
		print(f"  {log}")

	print("\n" + "=" * 60)
	print("–¢–ï–°–¢ 5: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ")
	print("=" * 60)

	# –ò–º–∏—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ –º–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
	def user_module():
		logger = AppLogger()
		logger.log("–ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞–≥—Ä—É–∂–µ–Ω", "INFO")

	def database_module():
		logger = AppLogger()
		logger.log("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", "INFO")

	def api_module():
		logger = AppLogger()
		logger.log("API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8000", "INFO")

	user_module()
	database_module()
	api_module()

	print("\nüìä –ò—Ç–æ–≥–æ–≤—ã–µ –ª–æ–≥–∏ —Å–æ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π:")
	final_logger = AppLogger()
	for log in final_logger.get_logs():
		print(f"  {log}")


if __name__ == "__main__":
	main()